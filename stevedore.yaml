boxes:
  centos: puppetlabs/centos-7.0-64-puppet
  ubuntu: puppetlabs/ubuntu-14.04-64-puppet

roles:
  swarm-manager:
    -
      type: shell
      script: 'scripts/install-swarm.sh'

  swarm:

  docker:
    -
      type: shell
      script: 'scripts/install-docker.sh'
      args:
        PACKAGECLOUD_TOKEN: "ENV['PACKAGECLOUD_TOKEN']"

  machine:
    -
      type: shell
      script: 'scripts/install-machine.sh'
      args:
        MACHINE_GIT_REF: 'HEAD'
        MACHINE_GIT_REPO: 'https://github.com/docker/machine.git'
        MACHINE_BINARY: ''

  compose:
    -
      type: shell
      script: 'scripts/install-compose.sh'
      args:
        COMPOSE_BINARY: 'https://github.com/docker/fig/releases/download/1.1.0-rc2/docker-compose-Darwin-x86_64'

  dtr:
    -
      type: shell
      script: 'scripts/install-dtr.sh'

vm_defaults: &defaults
  box: 'ubuntu'
  domain: 'docker.vm'
  memory: 1024
  cpus: 2
  ip_range: '192.168.56.32/28'
  roles: [docker, swarm]

vms:
  -
    <<: *defaults
    name: enterprise
    memory: 2048
    roles: [docker, dtr, swarm-manager]
  -
    <<: *defaults
    name: swarm01
    labels:
        storage: 'ssd'
        location: 'rack1'
  -
    <<: *defaults
    name: swarm02
    box: 'centos'
    labels:
        storage: 'magnetic'
        location: 'rack1'
  -
    <<: *defaults
    name: swarm03
    labels:
        storage: 'ssd'
        location: 'rack2'
  -
    <<: *defaults
    name: swarm04
    box: 'centos'
    labels:
       storage: 'magnetic'
       location: 'rack2'
