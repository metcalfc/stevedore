boxes:
  centos: metcalfc/centos7-docker
  ubuntu: metcalfc/trusty-docker

roles:
  swarm:
    provisioner:
      type: shell
      script: 'scripts/install-swarm.sh'
      args:
        -
          SWARM_GIT_REF: 'v0.1.0-rc1'
          SWARM_GIT_REPO: 'https://github.com/docker/swarm.git'
          SWARM_BINARY: 'https://github.com/docker/swarm/releases/download/v0.1.0-rc1/docker-swarm-Linux-x86_64'

  swarm-manager:
    provisioner:
      type: shell
      script: 'scripts/start-swarm.sh'

  compose:
    provisioner:
      type: shell
      script: 'scripts/install-compose.sh'
      args:
        -
          COMPOSE_GIT_REF: 'v0.1.0-rc1'
          COMPOSE_GIT_REPO: 'https://github.com/docker/swarm.git'
          COMPOSE_BINARY: 'https://github.com/docker/fig/releases/download/1.1.0-rc1/docker-compose-Linux-x86_64'

  machine:
    provisioner:
      type: shell
      script: 'scripts/install-machine.sh'
      args:
        -
          MACHINE_GIT_REF: 'v0.1.0-rc1'
          MACHINE_GIT_REPO: 'https://github.com/docker/swarm.git'
          MACHINE_BINARY: 'https://github.com/docker/machine/releases/download/v0.1.0-rc1/docker-machine_linux_amd64'

  docker:
    provisioner:
      type: shell
      script: 'scripts/install-machine.sh'
      args:
        -
          DOCKER_GIT_REF: 'v0.1.0-rc1'
          DOCKER_GIT_REPO: 'https://github.com/docker/swarm.git'
          DOCKER_BINARY: 'https://get.docker.com/builds/Linux/x86_64/docker-latest'

vm_defaults: &defaults
  box: 'ubuntu'
  domain: 'docker.vm'
  memory: 1024
  cpus: 2
  ip_range: '192.168.56.0/24'

vms:
  -
    <<: *defaults
    name: swarm01
    roles: [ swarm, swarm-manager ]
    labels:
      -
        storage: 'ssd'
  -
    <<: *defaults
    name: swarm02
    roles: [swarm]
    labels:
      -
        storage: 'magnetic'
        network: '10G'
  -
    <<: *defaults
    name: swarm03
    roles: [swarm]
  -
    <<: *defaults
    name: swarm04
    roles: [swarm]
  -
    <<: *defaults
    name: swarm05
    roles: [swarm]
  -
    <<: *defaults
    name: swarm06
    roles: [swarm]
